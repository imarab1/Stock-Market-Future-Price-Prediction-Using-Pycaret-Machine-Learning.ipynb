# -*- coding: utf-8 -*-
"""Stock Market Future Price Prediction Using Pycaret & Machine Learning.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1cVPMVD6okLSHBs1YmKXsADrGyeQNpmeA
"""

pip install pycaret

pip install markupsafe==2.0.1

pip install jinja2

import jinja2
from pycaret.regression import *
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split

from google.colab import files 
files.upload()

asset = pd.read_csv('')
asset = asset.set_index(pd.DatetimeIndex(asset['Data'].values))
asset

df3 = asset.copy()
X = np.array(df2[['Date', 'Open', 'Close']])
y = df3['Close'].values
x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.15, random_state = 0, shuffle= False)

train_data = pd.DataFrame(x_train, columns= ['Date', 'Open', 'Close'])
train_data.head(7)

s = setup(data=train_data, target='Close', session_id = 123, use_gpu = True)

compare_models(sort= 'MSE')

en = create_model('en')

predict_model(en, data=test_data.drop(['Close'], axis=1))

test_data['Close']